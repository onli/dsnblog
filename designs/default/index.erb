<%# -*- encoding : utf-8 -*- %>
<!DOCTYPE html>
<html>
    <head>
        <%= erb :head, :locals => {:tag => tag}%>
        <title><%= blogTitle %></title>
        <meta name="description" content="">
    </head>

    <body>
        
        <aside id="widget">
            <% if isAdmin? %>
                <div id="welcome">Welcome <%= authorized_email %> <form id="logout" action="<%= url_for '/logout' %>" method="POST"><button type="submit">Logout</button></form></div>
                <%= erb :designs, :locals => {:design => design, :designs => designs} %>
            <% else %>
                <%= render_login_button %>
            <% end %>
        </aside>

        <main itemscope itemtype="http://schema.org/Blog">
        
            <%= erb :header, :locals => {:blogTitle => blogTitle} %>
            
            <% if isAdmin? && (page.to_i == 0 || page.to_i == totalPages) && tag == nil %>
                <%= erb :editor, :locals => {:entry => nil} %>
                <datalist id="tags">
                    <%= allTags.map { |tag| '<option value="' + tag + '">'}.join(" ") %>
                </datalist>
            <% end %>

            <% entries.each do |entry| %>
                <article class="entry container" id="e<%= entry.id %>" itemscope itemtype="http://schema.org/BlogPosting">
                    <%= erb :entry, :locals => {:entry => entry} %>
                </article>
            <% end %>

            <nav id="browser">
                <% if page.to_i != 1 && page.to_i != 0 %>
                    <a id="browsePrior" rel="prev" href="<%= url_for '/archive/' + (page.to_i - 1).to_s %>/<%= tag %>">older</a>
                <% end %>
                <% if page.to_i != totalPages %>
                    <a id="browseNext" rel="next" href="<%= url_for '/archive/' + (page.to_i + 1).to_s %>/<%= tag %> ">newer</a>
                <% end %>  
            </nav>
            <footer>
                <%= erb :searchWidget, :locals => {:keyword => "" }%>
            </footer>
        </main>
    </body>
</html>
